# Generated by Chef for <%= node['fqdn'] %>
# Local modifications will be overwritten.

<% @acls.each do |acl| -%>
acl "<%= acl.name -%>" {
  <% acl.entries.each do |entry| -%>
  <%= entry -%>;
  <% end -%>
};

<% end -%>
options {
  directory "<%= @vardir %>";
  dump-file "data/cache_dump.db";
  statistics-file "data/named_stats.txt";
  memstatistics-file "data/named_mem_stats.txt";
  <% if @ipv6_listen -%>listen-on-v6 { any; };<% end -%>
  <% @options.each do |option_line| -%>
  <%= option_line %>;
  <% end -%>
};

<% if @query_log %>
logging {
  channel b_query {
    file "<%= @query_log %>" versions <%= @query_log_versions %> size <%= @query_log_max_size %>;
    print-time yes;
    severity info;
    <% @query_log_options.each do |option_line| -%>
    <%= option_line %>;
    <% end -%>
  };
  category queries { b_query; };
};

<% end %>
<% if @logging_channels.count > 0 || @logging_categories.count > 0 %>
logging {
  <% @logging_channels.each do |channel| -%>

  channel <%= channel.name %> {
    <%= channel.destination %>;
    severity <%= channel.severity %>;
    print-category <%= channel.print_category ? 'yes' : 'no' %>;
    print-severity <%= channel.print_severity ? 'yes' : 'no' %>;
    print-time <%= channel.print_time ? 'yes' : 'no' %>;
  };
  <% end -%>

  <% @logging_categories.each do |category| -%>
  category <%= category.name %> { <%= category.channels.map { |channel| channel + ';' }.join(' ') %> };
  <% end -%>
};

<% end %>
<% if @statistics_channel %>
statistics-channels {
  inet <%= @statistics_channel[:address] %> port <%= @statistics_channel[:port] -%>;
};
<% end %>
