# Generated by Chef for <%= node['fqdn'] %>
# Local modifications will be overwritten.
<% @additional_config_files.each do |file| -%>
include "<%= "#{@sysconfdir}/#{file}" %>";
<% end -%>

<% @servers.each do |server| %>
server <%= server.name %> {
  <% server.options.each do |option| -%>
  <%= option %>;
<% end -%>
};
<% end -%>

<% @keys.each do |key| %>
key "<%= key.name %>" {
  algorithm <%= key.algorithm %>;
  secret "<%= key.secret %>";
};
<% end %>

<% @primary_zones.each do |zone| -%>
zone "<%= zone.name %>" IN {
  type master;
  file "primary/db.<%= zone.name %>";
  <% zone.options.each do |option| -%>
  <%= option %>;
  <% end -%>
};

<% end -%>
<% @secondary_zones.each do |zone| -%>
zone "<%= zone.name %>" IN {
  type slave;
  file "secondary/db.<%= zone.name %>";
  masters { <%= zone.primaries.map { |primary| "#{primary};" }.join(' ') %> };
};

<% end -%>
<% @forward_zones.each do |zone| -%>
zone "<%= zone.name %>" IN {
  type forward;
  forwarders { <%= zone.forwarders.map { |forwarder| "#{forwarder};" }.join(' ') %> };
  forward <%= zone.forward %>;
  delegation-only <%= zone.delegation_only %>;
};

<% end -%>
zone "." IN {
  type hint;
  file "named.ca";
};
