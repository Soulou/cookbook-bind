# Generated by Chef for <%= node['fqdn'] %>
# Local modifications will be overwritten.
<% node['bind']['included_files'].each do |file| -%>
include "<%= "#{node['bind']['sysconfdir']}/#{file}" %>";
<% end -%>

<% unless node['bind']['server'].empty? %>
<% node['bind']['server'].each {|server_ip, options| %>
server <%= server_ip %> {
  <% options.each do |option| -%>
  <%= option %>
<% end -%>
};
<% } -%>
<% end -%>

<% @primary_zones.each do |zone| -%>
zone "<%= zone.name %>" IN {
  type master;
  file "primary/db.<%= zone.name %>";
};

<% end -%>
<% @secondary_zones.each do |zone| -%>
zone "<%= zone.name %>" IN {
  type slave;
  file "secondary/db.<%= zone.name %>";
  masters { <%= zone.primaries.map { |primary| "#{primary};" }.join(' ') %> };
};

<% end -%>

<% @forward_zones.each do |zone| -%>
zone "<%= zone.name %>" IN {
  type forward;
  forwarders { <%= zone.forwarders.map { |forwarder| "#{forwarder};" }.join(' ') %> };
  forward only;
};
<% end -%>

zone "." IN {
  type hint;
  file "named.ca";
};
