# Generated by Chef for <%= node['fqdn'] %>
# Local modifications will be overwritten.
<% @additional_config_files.each do |file| -%>
include "<%= "#{@sysconfdir}/#{file}" %>";
<% end -%>

<% @servers.each do |server| -%>
server <%= server.name %> {
  <% server.options.each do |option| -%>
  <%= option %>;
<% end -%>
};

<% end -%>
<% @keys.each do |key| -%>
key "<%= key.name %>" {
  algorithm <%= key.algorithm %>;
  secret "<%= key.secret %>";
};

<% end %>
<% if @views.length > 0 %>
<% @views.each do |view| %>
view "<%= view.name %>" {
<%=
  render(
    "_zones.erb", variables: {
      primary_zones: @primary_zones, # TODO: Select by zone
      secondary_zones: @secondary_zones,
      forward_zones: @forward_zones
    }
  ).gsub(/^/, '    ')
%>
};
<% end %>
<% else %>
<%=
  render "_zones.erb", variables: {
    primary_zones: @primary_zones,
    secondary_zones: @secondary_zones,
    forward_zones: @forward_zones
  }
%>
<% end %>
zone "." IN {
  type hint;
  file "named.ca";
};
